{"version":3,"file":"template.js","sources":["src/index.js"],"sourcesContent":["import { timingSafeEqual } from \"crypto\";\n\nexport let data = {};\n\n\nexport let state = {\n\n};\n\nexport function update() {\n\n  // DATA for Testing\n  let data = [110, 20, 12];\n\n  data.sort(function(a, b){return a-b});\n  //data.sort(d3.descending());\n  let width = \"705px\",\n      height = 70,\n      fontsize = 18,\n      center = \"0 auto\",\n      // goal = 705,\n      perc_so_far = 0;\n\n\n  //console.log(d3.sum(data));\n  let total = d3.sum(data);\n  let bar_x = 0;\n  let chart = d3.select(\"#pollviz\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n    bar_x = 0;\n    //let chart_width = chart.style(\"width\").replace(\"px\", \"\");\n  let chart_width = parseInt(d3.select(\"#pollviz\").style(\"width\"));\n  //console.log(chart_width);\n\n  let color = d3.scale.category10();\n  //console.log(color);\n    //d3.scale.ordinal()\n    //.domain([\"6TH\", \"7TH\", \"5TH\", \"4TH\"])\n    //.range(colorbrewer.RdBu[12]);\n  \n  let bar = chart.selectAll(\"g\")\n    .data(data)\n    .enter().append(\"g\");\n    //console.log(bar);\n  \n  bar.append(\"rect\")\n    .attr(\"width\", function(d) { return ((d/total)*100) + \"%\"; } )\n    .attr(\"x\", function(d) {\n      let prev_perc = perc_so_far;\n      let this_perc = 100*(d/total);\n      perc_so_far = perc_so_far + this_perc;\n      //console.log(\"perc_so_far:\" + perc_so_far + \"; this_perc:\" + this_perc + \"; prev_perc:\" + prev_perc + \";\");\n      return prev_perc + \"%\";\n    })\n    .attr(\"y\", \"50%\")\n    .attr(\"height\", height/2)\n    .attr(\"fill\",  function(d) { return (color(d)) } );\n\n  perc_so_far = 0;\n  \n  // let bartext = d3.selectAll(\"g\")\n  // .append(\"div\")\n  // .attr(\"class\", \"textbox\");\n\n  d3.selectAll(\"g\")\n    .append(\"text\")\n    .attr(\"x\", function(d,i) {\n\n      let prev_perc = perc_so_far;\n      let this_perc = 100*(d/total);\n      perc_so_far = perc_so_far + this_perc;\n      \n      if (i == 1){\n        //let balkentext = Number.parseFloat(100*(d/total)).toFixed(1) + \"%\";\n        //let textcenter = (((prev_perc) * 705) / 100);\n        console.log(perc_so_far);\n        console.log(prev_perc);\n        console.log(this_perc);\n        console.log(perc_so_far - prev_perc);\n        console.log((perc_so_far - prev_perc)/2);\n        console.log(prev_perc + (perc_so_far - prev_perc)/2);\n        let centric = prev_perc + (perc_so_far - prev_perc)/2;\n        console.log(centric);\n        return centric + \"%\";\n      }\n\n      if (i == 2){\n        return \"680px\"; //(prev_perc + \"%\")\n      }\n\n      //console.log(\"perc_so_far:\" + perc_so_far + \"; this_perc:\" + this_perc + \"; prev_perc:\" + prev_perc + \";\");\n      return 22;\n    })\n\n\n    //.attr(\"y\", 11)\n\n    // To middle/center in the bar-chart\n    // .attr(\"dy\", (height + (fontsize/2))/2)\n    \n    .attr(\"dy\", height/2 - fontsize/4)\n    \n    // .attr(\"fill\", \"#ffffff\")\n    // .attr(\"font-size\", fontsize + \"px\")\n    .text(function(d) { \n      let balkentext = Number.parseFloat(100*(d/total)).toFixed(1) + \"%\";\n      return balkentext; \n  });\n\n  // d3.selectAll('g').selectAll(\"text\").each(function(d,i){\n    \n  //   var firstChild = this.firstChild,\n  //       lastChild = this.lastChild;\n    \n  //   console.log(lastChild);\n\n  //   lastChild.attr(\"x\", \"705px\");\n  // })\n      \n  // d3.select(window).on('resize', resize);\n\n  //   function resize () {\n  //     let width = parseInt(d3.select(\"#chart\").style(\"width\"));\n  //     console.log(width);\n  //     console.log(bar);\n  //   }\n\n  }\n\nexport function draw() {\n  update();\n}\n"],"names":["update","data","sort","a","b","perc_so_far","total","d3","sum","chart","select","attr","color","parseInt","style","scale","category10","selectAll","enter","append","d","prev_perc","height","i","this_perc","console","log","centric","text","Number","parseFloat","toFixed"],"mappings":"wCASO,SAASA,IAGd,IAAIC,GAAQ,IAAK,GAAI,IAErBA,EAAKC,KAAK,SAASC,EAAGC,GAAG,OAAOD,EAAEC,IAElC,IAKIC,EAAc,EAIdC,EAAQC,GAAGC,IAAIP,GAEfQ,EAAQF,GAAGG,OAAO,YACnBC,KAAK,QAZI,SAaTA,KAAK,SAZK,IAkBTC,GAHcC,SAASN,GAAGG,OAAO,YAAYI,MAAM,UAG3CP,GAAGQ,MAAMC,cAMXP,EAAMQ,UAAU,KACvBhB,KAAKA,GACLiB,QAAQC,OAAO,KAGdA,OAAO,QACRR,KAAK,QAAS,SAASS,GAAK,OAASA,EAAEd,EAAO,IAAO,MACrDK,KAAK,IAAK,SAASS,GAClB,IAAIC,EAAYhB,EAIhB,OAFAA,GADqBe,EAAEd,EAAP,IAGTe,EAAY,MAEpBV,KAAK,IAAK,OACVA,KAAK,SAAUW,IACfX,KAAK,OAAS,SAASS,GAAK,OAAQR,EAAMQ,KAE7Cf,EAAc,EAMdE,GAAGU,UAAU,KACVE,OAAO,QACPR,KAAK,IAAK,SAASS,EAAEG,GAEpB,IAAIF,EAAYhB,EACZmB,EAAiBJ,EAAEd,EAAP,IAGhB,GAFAD,GAA4BmB,EAEnB,GAALD,EAAO,CAGTE,QAAQC,IAAIrB,GACZoB,QAAQC,IAAIL,GACZI,QAAQC,IAAIF,GACZC,QAAQC,IAAIrB,EAAcgB,GAC1BI,QAAQC,KAAKrB,EAAcgB,GAAW,GACtCI,QAAQC,IAAIL,GAAahB,EAAcgB,GAAW,GAClD,IAAIM,EAAUN,GAAahB,EAAcgB,GAAW,EAEpD,OADAI,QAAQC,IAAIC,GACLA,EAAU,IAGnB,OAAS,GAALJ,EACK,QAIF,KASRZ,KAAK,KAAMW,MAIXM,KAAK,SAASR,GAEb,OADiBS,OAAOC,WAAgBV,EAAEd,EAAP,KAAeyB,QAAQ,GAAK,oDAwB9D,WACL/B"}