{"version":3,"file":"template.js","sources":["src/index.js"],"sourcesContent":["export var data = {};\n// If your template includes data tables, use this variable to access the data.\n// Each of the 'datasets' in data.json file will be available as properties of the data.\n\nexport var state = {\n  // example_state_property: 25\n  // The current state of template. You can make some or all of the properties\n  // of the state object available to the user as settings in settings.js.\n};\n\nexport function update() {\n  // The update function is called whenever the user changes a data table or settings\n  // in the visualisation editor, or when changing slides in the story editor.\n\n  // Tip: to make your template work nicely in the story editor, ensure that all user\n  // interface controls such as buttons and sliders update the state and then call update.\n\n  // DATA for Testing\n  var data = [16, 23, 42];\n\n  data.sort(function(a, b){return a-b});\n  //data.sort(d3.descending());\n  var width = \"100%\",\n      height = 30,\n      goal = 705,\n      perc_so_far = 0;\n\n\n  //console.log(d3.sum(data));\n  var total_time = d3.sum(data);\n  var bar_x = 0;\n  var chart = d3.select(\"#pollviz\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n    bar_x = 0;\n    //var chart_width = chart.style(\"width\").replace(\"px\", \"\");\n  var chart_width = parseInt(d3.select(\"#pollviz\").style(\"width\"));\n  console.log(chart_width);\n\n  var color = d3.scale.category10();\n  //console.log(color);\n    //d3.scale.ordinal()\n    //.domain([\"6TH\", \"7TH\", \"5TH\", \"4TH\"])\n    //.range(colorbrewer.RdBu[12]);\n  var bar = chart.selectAll(\"g\")\n    .data(data)\n    .enter().append(\"g\");\n    //console.log(bar);\n  bar.append(\"rect\")\n    .attr(\"width\", function(d) { return ((d/total_time)*100) + \"%\"; } )\n    .attr(\"x\", function(d) {\n      var prev_perc = perc_so_far;\n      var this_perc = 100*(d/total_time);\n      perc_so_far = perc_so_far + this_perc;\n      //console.log(\"perc_so_far:\" + perc_so_far + \"; this_perc:\" + this_perc + \"; prev_perc:\" + prev_perc + \";\");\n      return prev_perc + \"%\";\n    })\n    .attr(\"height\", height)\n    .attr(\"fill\",  function(d) { return (color(d)) } );\n\n  perc_so_far = 0;\n  bar.append(\"text\")\n    .attr(\"x\", function(d) {\n      var prev_perc = perc_so_far;\n      var this_perc = 100*(d/total_time);\n      perc_so_far = perc_so_far + this_perc;\n      //console.log(\"perc_so_far:\" + perc_so_far + \"; this_perc:\" + this_perc + \"; prev_perc:\" + prev_perc + \";\");\n      return prev_perc + 0.5 + \"%\";\n    })\n    //.attr(\"y\", 11)\n    .attr(\"dy\", \"1.35em\")\n    .text(function(d) { return Number.parseFloat(100*(d/total_time)).toFixed(1) + \"%\"; });\n      \n  // d3.select(window).on('resize', resize);\n\n  //   function resize () {\n  //     var width = parseInt(d3.select(\"#chart\").style(\"width\"));\n  //     console.log(width);\n  //     console.log(bar);\n  //   }\n\n  }\n\nexport function draw() {\n  // The draw function is called when the template first loads\n  update();\n}\n"],"names":["update","data","sort","a","b","perc_so_far","total_time","d3","sum","chart","select","attr","chart_width","parseInt","style","console","log","color","scale","category10","bar","selectAll","enter","append","d","prev_perc","text","Number","parseFloat","toFixed"],"mappings":"sCAUO,SAASA,IAQd,IAAIC,GAAQ,GAAI,GAAI,IAEpBA,EAAKC,KAAK,SAASC,EAAGC,GAAG,OAAOD,EAAEC,IAElC,IAEIC,EACc,EAIdC,EAAaC,GAAGC,IAAIP,GAEpBQ,EAAQF,GAAGG,OAAO,YACnBC,KAAK,QAVI,QAWTA,KAAK,SAVK,IAaTC,EAAcC,SAASN,GAAGG,OAAO,YAAYI,MAAM,UACvDC,QAAQC,IAAIJ,GAEZ,IAAIK,EAAQV,GAAGW,MAAMC,aAKjBC,EAAMX,EAAMY,UAAU,KACvBpB,KAAKA,GACLqB,QAAQC,OAAO,KAElBH,EAAIG,OAAO,QACRZ,KAAK,QAAS,SAASa,GAAK,OAASA,EAAElB,EAAY,IAAO,MAC1DK,KAAK,IAAK,SAASa,GAClB,IAAIC,EAAYpB,EAIhB,OAFAA,GADqBmB,EAAElB,EAAP,IAGTmB,EAAY,MAEpBd,KAAK,SAlCK,IAmCVA,KAAK,OAAS,SAASa,GAAK,OAAQP,EAAMO,KAE7CnB,EAAc,EACde,EAAIG,OAAO,QACRZ,KAAK,IAAK,SAASa,GAClB,IAAIC,EAAYpB,EAIhB,OAFAA,GADqBmB,EAAElB,EAAP,IAGTmB,EAAY,GAAM,MAG1Bd,KAAK,KAAM,UACXe,KAAK,SAASF,GAAK,OAAOG,OAAOC,WAAgBJ,EAAElB,EAAP,KAAoBuB,QAAQ,GAAK,oDAY3E,WAEL7B"}